# URL del Webhook Discord
$webhookUrl = 'https://discord.com/api/webhooks/1305148744034942987/rIucBCJqT3ZvW9zzlZiE889d11X5xaKSk1h8cgK-LwaiRFBhX-iwowFKg9xAVZHt326I'

# Raccogli informazioni di sistema
$computerInfo = Get-ComputerInfo
$cpuInfo = Get-WmiObject Win32_Processor | Select-Object -First 1
$memoryInfo = Get-WmiObject Win32_OperatingSystem
$osInfo = $computerInfo.OsArchitecture
$csName = $computerInfo.CSName
$windowsVersion = $computerInfo.WindowsVersion
$cpuName = $cpuInfo.Name
$totalMemory = [math]::round($memoryInfo.TotalVisibleMemorySize / 1MB, 2) # Total Memory in MB
$freeMemory = [math]::round($memoryInfo.FreePhysicalMemory / 1MB, 2) # Free Memory in MB

# Costruisci il payload da inviare
$payload = @{
    content = "Informazioni di Sistema:
    - Sistema Operativo: $osInfo
    - Computer: $csName
    - Versione Windows: $windowsVersion
    - Processore: $cpuName
    - Memoria Totale: $totalMemory MB
    - Memoria Libera: $freeMemory MB"
} | ConvertTo-Json

# Debug: mostra il contenuto del payload
Write-Host "Invio al Webhook: $($payload.content)"

# Invio al Webhook Discord
Invoke-RestMethod -Uri $webhookUrl -Method Post -Body $payload -ContentType "application/json"
